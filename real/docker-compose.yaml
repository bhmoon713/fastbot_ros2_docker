version: "3"
services:
  fastbot-ros2-real:
    image: bhmoon418/bhmoon713-cp22:fastbot-ros2-real
    container_name: fastbot-ros2-real
    network_mode: host
    cap_add:
      - NET_ADMIN
    environment:
      - XAUTHORITY=${XAUTHORITY}
      - RMW_IMPLEMENTATION=rmw_cyclonedds_cpp
      - ROS_DOMAIN_ID=0
      - ROS_IPV6=off
      - CYCLONEDDS_URI=/var/lib/theconstruct.rrl/cyclonedds.xml
    devices:
      - /dev/video0:/dev/video0
      - /dev/ttyACM0:/dev/lslidar
      - /dev/ttyUSB0:/dev/arduino_nano
    group_add:
      - dialout
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ./cyclonedds.xml:/etc/cyclonedds.xml:ro
    privileged: true
    restart: always

  fastbot-ros2-slam-real:

    image: bhmoon418/bhmoon713-cp22:fastbot-ros2-slam-real
    container_name: fastbot-ros2-slam-real
    network_mode: host
    depends_on:
      - fastbot-ros2-real
    environment:
      - DISPLAY=${DISPLAY}
      - XAUTHORITY=${XAUTHORITY}
      - RMW_IMPLEMENTATION=rmw_cyclonedds_cpp
      - ROS_DOMAIN_ID=0
      - ROS_IPV6=off
      - CYCLONEDDS_URI=/var/lib/theconstruct.rrl/cyclonedds.xml
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ./cyclonedds.xml:/etc/cyclonedds.xml:ro

